services:
  - postgres

stages:
  - build
  - test
  - deploy

job1:
  stage: build
  script:
    - ./gradlew build -x test

job2:
  stage: test
  script:
    - ./gradlew build

job3:
  stage: deploy
  before_script:
    - fuser -k 8080/tcp
    - gradlew --stop
  script:
    - ./gradlew bootRun &

